<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Heart AR</title>

    <!-- A-Frame and AR.js -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/loaders/FBXLoader.js"></script>

    <style>
        body { margin: 0; overflow: hidden; }
        a-scene { width: 100vw; height: 100vh; }
    </style>
</head>
<body>
    <a-scene embedded arjs>
        <!-- AR Marker -->
        <a-marker preset="hiro">
            <!-- Placeholder for the 3D heart -->
            <a-entity id="heart" position="0 0 0" scale="0.05 0.05 0.05"></a-entity>
        </a-marker>

        <!-- Camera -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // Reference to the 3D heart entity
        const heartEntity = document.getElementById("heart");

        // Initialize FBXLoader
        const loader = new THREE.FBXLoader();

        // Load the heart model
        loader.load('./heart/heart.fbx', (object) => {
            const textureLoader = new THREE.TextureLoader();

            // Load textures
            const baseColor = textureLoader.load('./heart/hart_UV_low01_BaseColor.hart_UV_low_defaultMat.png');
            const metalness = textureLoader.load('./heart/hart_UV_low01_Metalness.hart_UV_low_defaultMat.png');
            const normalMap = textureLoader.load('./heart/hart_UV_low01_Normal.hart_UV_low_defaultMat.png');
            const roughness = textureLoader.load('./heart/hart_UV_low01_Roughness.hart_UV_low_defaultMat.png');

            // Apply textures to the 3D model
            object.traverse((child) => {
                if (child.isMesh) {
                    child.material = new THREE.MeshStandardMaterial({
                        map: baseColor,
                        metalnessMap: metalness,
                        normalMap: normalMap,
                        roughnessMap: roughness,
                    });
                }
            });

            // Add the model to the marker
            heartEntity.object3D.add(object);
        }, undefined, (error) => {
            console.error("Error loading the model:", error);
        });
    </script>
</body>
</html>
